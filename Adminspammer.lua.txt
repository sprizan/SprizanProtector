-- Roblox Admin Command Auto-Clicker UI (Small Emoji Toggles)
-- Place this in StarterGui or StarterPlayerScripts

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AdminSpammerUI"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = playerGui

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 340, 0, 420)
mainFrame.Position = UDim2.new(0.5, -170, 0.5, -210)
mainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 16)
mainCorner.Parent = mainFrame

local mainStroke = Instance.new("UIStroke")
mainStroke.Color = Color3.fromRGB(147, 51, 234)
mainStroke.Thickness = 2
mainStroke.Transparency = 0.5
mainStroke.Parent = mainFrame

-- Header Frame with Gradient
local header = Instance.new("Frame")
header.Name = "Header"
header.Size = UDim2.new(1, 0, 0, 45)
header.Position = UDim2.new(0, 0, 0, 0)
header.BackgroundColor3 = Color3.fromRGB(147, 51, 234)
header.BorderSizePixel = 0
header.Parent = mainFrame

local headerGradient = Instance.new("UIGradient")
headerGradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(147, 51, 234)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(126, 34, 206))
}
headerGradient.Rotation = 90
headerGradient.Parent = header

local headerCorner = Instance.new("UICorner")
headerCorner.CornerRadius = UDim.new(0, 16)
headerCorner.Parent = header

local headerCover = Instance.new("Frame")
headerCover.Size = UDim2.new(1, 0, 0, 16)
headerCover.Position = UDim2.new(0, 0, 1, -16)
headerCover.BackgroundColor3 = Color3.fromRGB(147, 51, 234)
headerCover.BorderSizePixel = 0
headerCover.Parent = header

local headerCoverGradient = Instance.new("UIGradient")
headerCoverGradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(147, 51, 234)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(126, 34, 206))
}
headerCoverGradient.Rotation = 90
headerCoverGradient.Parent = headerCover

-- Title with Icon
local title = Instance.new("TextLabel")
title.Name = "Sprizan"
title.Size = UDim2.new(0, 250, 0, 18)
title.Position = UDim2.new(0, 12, 0, 6)
title.BackgroundTransparency = 1
title.Text = "‚ö° Sprizan Spamm"
title.Font = Enum.Font.GothamBold
title.TextSize = 15
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = header

local discordLink = Instance.new("TextLabel")
discordLink.Name = "DiscordLink"
discordLink.Size = UDim2.new(0, 250, 0, 12)
discordLink.Position = UDim2.new(0, 12, 0, 26)
discordLink.BackgroundTransparency = 1
discordLink.Text = "discord.gg/DAA3d7BcPU"
discordLink.Font = Enum.Font.Gotham
discordLink.TextSize = 10
discordLink.TextColor3 = Color3.fromRGB(220, 200, 255)
discordLink.TextXAlignment = Enum.TextXAlignment.Left
discordLink.Parent = header

-- Minimize Button
local minimizeBtn = Instance.new("TextButton")
minimizeBtn.Name = "MinimizeButton"
minimizeBtn.Size = UDim2.new(0, 30, 0, 30)
minimizeBtn.Position = UDim2.new(1, -38, 0, 7.5)
minimizeBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
minimizeBtn.Text = "‚îÄ"
minimizeBtn.Font = Enum.Font.GothamBold
minimizeBtn.TextSize = 16
minimizeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeBtn.Parent = header

local minBtnCorner = Instance.new("UICorner")
minBtnCorner.CornerRadius = UDim.new(0, 8)
minBtnCorner.Parent = minimizeBtn

-- Body Frame
local body = Instance.new("Frame")
body.Name = "Body"
body.Size = UDim2.new(1, 0, 1, -45)
body.Position = UDim2.new(0, 0, 0, 45)
body.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
body.BorderSizePixel = 0
body.Parent = mainFrame

local bodyCorner = Instance.new("UICorner")
bodyCorner.CornerRadius = UDim.new(0, 16)
bodyCorner.Parent = body

local bodyCover = Instance.new("Frame")
bodyCover.Size = UDim2.new(1, 0, 0, 16)
bodyCover.Position = UDim2.new(0, 0, 0, 0)
bodyCover.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
bodyCover.BorderSizePixel = 0
bodyCover.Parent = body

-- Content Frame
local contentFrame = Instance.new("ScrollingFrame")
contentFrame.Name = "ContentFrame"
contentFrame.Size = UDim2.new(1, -20, 1, -20)
contentFrame.Position = UDim2.new(0, 10, 0, 10)
contentFrame.BackgroundTransparency = 1
contentFrame.BorderSizePixel = 0
contentFrame.ScrollBarThickness = 5
contentFrame.ScrollBarImageColor3 = Color3.fromRGB(147, 51, 234)
contentFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
contentFrame.Parent = body

local contentLayout = Instance.new("UIListLayout")
contentLayout.SortOrder = Enum.SortOrder.LayoutOrder
contentLayout.Padding = UDim.new(0, 8)
contentLayout.Parent = contentFrame

-- Notification Frame
local notificationFrame = Instance.new("Frame")
notificationFrame.Name = "Notification"
notificationFrame.Size = UDim2.new(0, 300, 0, 55)
notificationFrame.Position = UDim2.new(0.5, -150, 0, -70)
notificationFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
notificationFrame.BorderSizePixel = 0
notificationFrame.Visible = false
notificationFrame.Parent = screenGui

local notifCorner = Instance.new("UICorner")
notifCorner.CornerRadius = UDim.new(0, 12)
notifCorner.Parent = notificationFrame

local notifStroke = Instance.new("UIStroke")
notifStroke.Color = Color3.fromRGB(147, 51, 234)
notifStroke.Thickness = 2
notifStroke.Parent = notificationFrame

local notifTitle = Instance.new("TextLabel")
notifTitle.Size = UDim2.new(1, -20, 0, 22)
notifTitle.Position = UDim2.new(0, 10, 0, 6)
notifTitle.BackgroundTransparency = 1
notifTitle.Text = "‚úÖ Spam Completed"
notifTitle.Font = Enum.Font.GothamBold
notifTitle.TextSize = 14
notifTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
notifTitle.TextXAlignment = Enum.TextXAlignment.Left
notifTitle.Parent = notificationFrame

local notifMessage = Instance.new("TextLabel")
notifMessage.Size = UDim2.new(1, -20, 0, 18)
notifMessage.Position = UDim2.new(0, 10, 0, 30)
notifMessage.BackgroundTransparency = 1
notifMessage.Text = "All commands executed successfully"
notifMessage.Font = Enum.Font.Gotham
notifMessage.TextSize = 11
notifMessage.TextColor3 = Color3.fromRGB(180, 180, 200)
notifMessage.TextXAlignment = Enum.TextXAlignment.Left
notifMessage.Parent = notificationFrame

-- Function to show notification
local notificationActive = false
local function showNotification(title, message, duration)
	if notificationActive then return end
	notificationActive = true
	
	notifTitle.Text = title
	notifMessage.Text = message
	notificationFrame.Visible = true
	
	notificationFrame:TweenPosition(
		UDim2.new(0.5, -150, 0, 20),
		Enum.EasingDirection.Out,
		Enum.EasingStyle.Back,
		0.5,
		true
	)
	
	task.wait(duration or 3)
	notificationFrame:TweenPosition(
		UDim2.new(0.5, -150, 0, -70),
		Enum.EasingDirection.In,
		Enum.EasingStyle.Back,
		0.5,
		true,
		function()
			notificationFrame.Visible = false
			notificationActive = false
		end
	)
end

-- Spam control
local spamming = {}
local commandStates = {} -- Store which commands are enabled per player

-- Command definitions with emojis (SMALL BOXES)
local COMMANDS = {
	{name = "rocket", emoji = "üöÄ"},
	{name = "balloon", emoji = "üéà"},
	{name = "nightvision", emoji = "üåô"},
	{name = "control", emoji = "üéÆ"},
	{name = "jumpscare", emoji = "üëª"},
	{name = "ragdoll", emoji = "ü§∏"},
	{name = "inverse", emoji = "üîÑ"},
	{name = "jail", emoji = "‚õìÔ∏è"},
	{name = "tiny", emoji = "üî¨"},
	{name = "morph", emoji = "ü¶é"},
}

local function findAdminPanel()
	local adminPanel = playerGui:FindFirstChild("AdminPanel")
	return adminPanel
end

local function findPlayerButton(targetPlayer)
	local adminPanel = findAdminPanel()
	if not adminPanel then
		return nil
	end
	
	local targetDisplayName = targetPlayer.DisplayName
	local targetUserName = targetPlayer.Name
	
	for _, descendant in pairs(adminPanel:GetDescendants()) do
		if (descendant:IsA("TextButton") or descendant:IsA("ImageButton")) then
			local buttonText = ""
			if descendant:IsA("TextButton") then
				buttonText = descendant.Text
			else
				for _, child in pairs(descendant:GetDescendants()) do
					if child:IsA("TextLabel") then
						buttonText = child.Text
						break
					end
				end
			end
			
			if buttonText == targetDisplayName or buttonText:find(targetDisplayName) or 
			   buttonText == targetUserName or buttonText:find(targetUserName) then
				return descendant
			end
		end
	end
	
	return nil
end

local function getCommandButtons()
	local buttons = {}
	local adminPanel = findAdminPanel()
	
	if not adminPanel then
		return buttons
	end
	
	for _, descendant in pairs(adminPanel:GetDescendants()) do
		if descendant:IsA("TextButton") or descendant:IsA("ImageButton") then
			local text = ""
			if descendant:IsA("TextButton") then
				text = descendant.Text
			elseif descendant:IsA("ImageButton") then
				for _, child in pairs(descendant:GetDescendants()) do
					if child:IsA("TextLabel") and child.Text ~= "" then
						text = child.Text
						break
					end
				end
			end
			
			if text and text ~= "" and (text:match("^:") or text:match("^;")) then
				table.insert(buttons, {button = descendant, name = text})
			end
		end
	end
	
	return buttons
end

local function clickButton(button)
	pcall(function()
		for _, connection in pairs(getconnections(button.MouseButton1Click)) do
			connection:Fire()
		end
		for _, connection in pairs(getconnections(button.Activated)) do
			connection:Fire()
		end
	end)
end

local function executeCommandOnPlayer(targetPlayer, commandButtons, statusLabel)
	local adminPanel = findAdminPanel()
	if not adminPanel then
		return false
	end
	
	local playerKey = targetPlayer.Name
	local enabledCommands = commandStates[playerKey] or {}
	
	-- Filter commands based on what's enabled
	local commandsToExecute = {}
	for _, commandData in pairs(commandButtons) do
		local cmdLower = commandData.name:lower()
		for _, cmd in pairs(COMMANDS) do
			if cmdLower:find(cmd.name) and enabledCommands[cmd.name] then
				table.insert(commandsToExecute, commandData)
				break
			end
		end
	end
	
	if #commandsToExecute == 0 then
		statusLabel.Text = "‚ö†Ô∏è No commands enabled"
		statusLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
		return false
	end
	
	for i, commandData in pairs(commandsToExecute) do
		if not spamming[playerKey] then break end
		
		local playerButton = findPlayerButton(targetPlayer)
		if playerButton then
			clickButton(playerButton)
			task.wait(0.01)
		else
			statusLabel.Text = "‚ùå Player not found"
			continue
		end
		
		clickButton(commandData.button)
		
		-- Find emoji for status
		local emoji = "‚ö°"
		for _, cmd in pairs(COMMANDS) do
			if commandData.name:lower():find(cmd.name) then
				emoji = cmd.emoji
				break
			end
		end
		
		statusLabel.Text = emoji .. " Executing..."
		
		task.wait(0.01)
	end
	
	return true
end

local function spamAllCommands(targetPlayer, statusLabel)
	task.spawn(function()
		local commandButtons = getCommandButtons()
		
		if #commandButtons == 0 then
			statusLabel.Text = "‚ùå No commands found"
			statusLabel.TextColor3 = Color3.fromRGB(220, 38, 38)
		else
			executeCommandOnPlayer(targetPlayer, commandButtons, statusLabel)
		end
		
		spamming[targetPlayer.Name] = false
		statusLabel.Text = "‚úÖ Complete!"
		statusLabel.TextColor3 = Color3.fromRGB(100, 220, 100)
		
		for _, child in pairs(contentFrame:GetChildren()) do
			if child:IsA("Frame") and child.Name == targetPlayer.Name then
				local btn = child:FindFirstChild("SpamButton")
				if btn then
					btn.Text = "‚ñ∂ Spam"
					btn.BackgroundColor3 = Color3.fromRGB(147, 51, 234)
				end
			end
		end
		
		task.wait(2)
		statusLabel.Text = "Ready"
		statusLabel.TextColor3 = Color3.fromRGB(156, 163, 175)
		
		showNotification("‚úÖ Spam Completed", "All enabled commands executed", 3)
	end)
end

-- Function to create SMALL emoji toggle button (RED disabled, GREEN enabled)
local function createCommandToggle(commandData, parent, targetPlayer)
	local playerKey = targetPlayer.Name
	
	-- Initialize command state if not exists
	if not commandStates[playerKey] then
		commandStates[playerKey] = {}
	end
	if commandStates[playerKey][commandData.name] == nil then
		commandStates[playerKey][commandData.name] = true -- Default enabled
	end
	
	local toggle = Instance.new("TextButton")
	toggle.Name = commandData.name .. "Toggle"
	toggle.Size = UDim2.new(0, 28, 0, 28) -- SMALL BOX
	toggle.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
	toggle.BorderSizePixel = 0
	toggle.Text = commandData.emoji
	toggle.Font = Enum.Font.Gotham
	toggle.TextSize = 16
	toggle.Parent = parent
	
	local toggleCorner = Instance.new("UICorner")
	toggleCorner.CornerRadius = UDim.new(0, 6)
	toggleCorner.Parent = toggle
	
	-- Update visual state (RED = disabled, GREEN = enabled)
	local function updateToggleState()
		local isEnabled = commandStates[playerKey][commandData.name]
		if isEnabled then
			-- GREEN when enabled
			toggle.BackgroundColor3 = Color3.fromRGB(34, 197, 94) -- Green
			toggle.TextTransparency = 0
		else
			-- RED when disabled
			toggle.BackgroundColor3 = Color3.fromRGB(220, 38, 38) -- Red
			toggle.TextTransparency = 0.3
		end
	end
	
	updateToggleState()
	
	-- Toggle functionality
	toggle.MouseButton1Click:Connect(function()
		commandStates[playerKey][commandData.name] = not commandStates[playerKey][commandData.name]
		updateToggleState()
		
		-- Quick scale animation
		toggle:TweenSize(
			UDim2.new(0, 32, 0, 32),
			Enum.EasingDirection.Out,
			Enum.EasingStyle.Elastic,
			0.3,
			true,
			function()
				toggle:TweenSize(
					UDim2.new(0, 28, 0, 28),
					Enum.EasingDirection.Out,
					Enum.EasingStyle.Elastic,
					0.3,
					true
				)
			end
		)
	end)
	
	-- Hover effect
	toggle.MouseEnter:Connect(function()
		toggle:TweenSize(
			UDim2.new(0, 30, 0, 30),
			Enum.EasingDirection.Out,
			Enum.EasingStyle.Quad,
			0.1,
			true
		)
	end)
	
	toggle.MouseLeave:Connect(function()
		toggle:TweenSize(
			UDim2.new(0, 28, 0, 28),
			Enum.EasingDirection.Out,
			Enum.EasingStyle.Quad,
			0.1,
			true
		)
	end)
	
	return toggle
end

-- Function to create player card
local function createPlayerCard(targetPlayer)
	local card = Instance.new("Frame")
	card.Name = targetPlayer.Name
	card.Size = UDim2.new(1, 0, 0, 120) -- Compact height
	card.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
	card.BorderSizePixel = 0
	card.Parent = contentFrame
	
	local cardCorner = Instance.new("UICorner")
	cardCorner.CornerRadius = UDim.new(0, 12)
	cardCorner.Parent = card
	
	local cardStroke = Instance.new("UIStroke")
	cardStroke.Color = Color3.fromRGB(147, 51, 234)
	cardStroke.Transparency = 0.6
	cardStroke.Thickness = 1.5
	cardStroke.Parent = card
	
	-- Top section with player info
	local topSection = Instance.new("Frame")
	topSection.Size = UDim2.new(1, 0, 0, 50)
	topSection.BackgroundTransparency = 1
	topSection.Parent = card
	
	-- Character Image
	local avatarFrame = Instance.new("Frame")
	avatarFrame.Size = UDim2.new(0, 40, 0, 40)
	avatarFrame.Position = UDim2.new(0, 8, 0, 5)
	avatarFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
	avatarFrame.BorderSizePixel = 0
	avatarFrame.Parent = topSection
	
	local avatarCorner = Instance.new("UICorner")
	avatarCorner.CornerRadius = UDim.new(0, 8)
	avatarCorner.Parent = avatarFrame
	
	local avatarStroke = Instance.new("UIStroke")
	avatarStroke.Color = Color3.fromRGB(147, 51, 234)
	avatarStroke.Thickness = 2.5
	avatarStroke.Parent = avatarFrame
	
	local avatarImage = Instance.new("ImageLabel")
	avatarImage.Size = UDim2.new(1, 0, 1, 0)
	avatarImage.BackgroundTransparency = 1
	avatarImage.Image = "rbxthumb://type=AvatarHeadShot&id=" .. targetPlayer.UserId .. "&w=150&h=150"
	avatarImage.Parent = avatarFrame
	
	local avatarImageCorner = Instance.new("UICorner")
	avatarImageCorner.CornerRadius = UDim.new(0, 8)
	avatarImageCorner.Parent = avatarImage
	
	-- Player name
	local nameLabel = Instance.new("TextLabel")
	nameLabel.Size = UDim2.new(0, 150, 0, 18)
	nameLabel.Position = UDim2.new(0, 54, 0, 8)
	nameLabel.BackgroundTransparency = 1
	nameLabel.Text = targetPlayer.DisplayName
	nameLabel.Font = Enum.Font.GothamBold
	nameLabel.TextSize = 13
	nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	nameLabel.TextXAlignment = Enum.TextXAlignment.Left
	nameLabel.Parent = topSection
	
	-- Status label
	local statusLabel = Instance.new("TextLabel")
	statusLabel.Size = UDim2.new(0, 150, 0, 14)
	statusLabel.Position = UDim2.new(0, 54, 0, 28)
	statusLabel.BackgroundTransparency = 1
	if targetPlayer.DisplayName ~= targetPlayer.Name then
		statusLabel.Text = "@" .. targetPlayer.Name
	else
		statusLabel.Text = "Ready"
	end
	statusLabel.Font = Enum.Font.Gotham
	statusLabel.TextSize = 10
	statusLabel.TextColor3 = Color3.fromRGB(156, 163, 175)
	statusLabel.TextXAlignment = Enum.TextXAlignment.Left
	statusLabel.Parent = topSection
	
	-- Spam button
	local spamBtn = Instance.new("TextButton")
	spamBtn.Name = "SpamButton"
	spamBtn.Size = UDim2.new(0, 65, 0, 30)
	spamBtn.Position = UDim2.new(1, -73, 0, 10)
	spamBtn.BackgroundColor3 = Color3.fromRGB(147, 51, 234)
	spamBtn.Text = "‚ñ∂ Spam"
	spamBtn.Font = Enum.Font.GothamBold
	spamBtn.TextSize = 11
	spamBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
	spamBtn.Parent = topSection
	
	local spamBtnCorner = Instance.new("UICorner")
	spamBtnCorner.CornerRadius = UDim.new(0, 8)
	spamBtnCorner.Parent = spamBtn
	
	local spamBtnGradient = Instance.new("UIGradient")
	spamBtnGradient.Color = ColorSequence.new{
		ColorSequenceKeypoint.new(0, Color3.fromRGB(147, 51, 234)),
		ColorSequenceKeypoint.new(1, Color3.fromRGB(126, 34, 206))
	}
	spamBtnGradient.Rotation = 90
	spamBtnGradient.Parent = spamBtn
	
	-- Divider line
	local divider = Instance.new("Frame")
	divider.Size = UDim2.new(1, -16, 0, 1)
	divider.Position = UDim2.new(0, 8, 0, 52)
	divider.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
	divider.BorderSizePixel = 0
	divider.Parent = card
	
	-- Command section (COMPACT)
	local commandSection = Instance.new("Frame")
	commandSection.Size = UDim2.new(1, -16, 0, 60)
	commandSection.Position = UDim2.new(0, 8, 0, 56)
	commandSection.BackgroundTransparency = 1
	commandSection.Parent = card
	
	-- Command toggles container
	local commandGrid = Instance.new("Frame")
	commandGrid.Size = UDim2.new(1, 0, 1, 0)
	commandGrid.BackgroundTransparency = 1
	commandGrid.Parent = commandSection
	
	local gridLayout = Instance.new("UIGridLayout")
	gridLayout.CellSize = UDim2.new(0, 28, 0, 28) -- SMALL BOXES
	gridLayout.CellPadding = UDim2.new(0, 4, 0, 4)
	gridLayout.SortOrder = Enum.SortOrder.LayoutOrder
	gridLayout.Parent = commandGrid
	
	-- Create command toggles
	for _, cmd in ipairs(COMMANDS) do
		createCommandToggle(cmd, commandGrid, targetPlayer)
	end
	
	-- Button hover effect
	spamBtn.MouseEnter:Connect(function()
		if not spamming[targetPlayer.Name] then
			spamBtn.BackgroundColor3 = Color3.fromRGB(160, 70, 250)
		end
	end)
	
	spamBtn.MouseLeave:Connect(function()
		if not spamming[targetPlayer.Name] then
			spamBtn.BackgroundColor3 = Color3.fromRGB(147, 51, 234)
		end
	end)
	
	-- Spam functionality
	spamBtn.MouseButton1Click:Connect(function()
		if not spamming[targetPlayer.Name] then
			spamming[targetPlayer.Name] = true
			spamBtn.Text = "‚è∏ Stop"
			spamBtn.BackgroundColor3 = Color3.fromRGB(220, 38, 38)
			statusLabel.Text = "‚ö° Starting..."
			statusLabel.TextColor3 = Color3.fromRGB(147, 51, 234)
			
			spamAllCommands(targetPlayer, statusLabel)
		end
	end)
	
	-- Remove card when player leaves
	targetPlayer.AncestryChanged:Connect(function()
		if not targetPlayer:IsDescendantOf(game) then
			spamming[targetPlayer.Name] = false
			commandStates[targetPlayer.Name] = nil
			card:Destroy()
		end
	end)
	
	return card
end

-- Function to refresh player list
local function refreshPlayers()
	for _, child in pairs(contentFrame:GetChildren()) do
		if child:IsA("Frame") then
			child:Destroy()
		end
	end
	
	for _, targetPlayer in pairs(Players:GetPlayers()) do
		if targetPlayer ~= player then
			createPlayerCard(targetPlayer)
		end
	end
	
	contentFrame.CanvasSize = UDim2.new(0, 0, 0, contentLayout.AbsoluteContentSize.Y + 10)
end

-- Initial player load
refreshPlayers()

-- Update when players join/leave
Players.PlayerAdded:Connect(function(targetPlayer)
	if targetPlayer ~= player then
		createPlayerCard(targetPlayer)
		contentFrame.CanvasSize = UDim2.new(0, 0, 0, contentLayout.AbsoluteContentSize.Y + 10)
	end
end)

Players.PlayerRemoving:Connect(function(targetPlayer)
	spamming[targetPlayer.Name] = false
	commandStates[targetPlayer.Name] = nil
end)

-- Update canvas size when layout changes
contentLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
	contentFrame.CanvasSize = UDim2.new(0, 0, 0, contentLayout.AbsoluteContentSize.Y + 10)
end)

-- Minimize functionality
local isMinimized = false
minimizeBtn.MouseButton1Click:Connect(function()
	isMinimized = not isMinimized
	body.Visible = not isMinimized
	
	if isMinimized then
		mainFrame.Size = UDim2.new(0, 340, 0, 45)
		minimizeBtn.Text = "+"
	else
		mainFrame.Size = UDim2.new(0, 340, 0, 420)
		minimizeBtn.Text = "‚îÄ"
	end
end)

-- Make draggable
local dragging
local dragInput
local dragStart
local startPos

local function update(input)
	local delta = input.Position - dragStart
	mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

header.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = mainFrame.Position
		
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

header.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		dragInput = input
	end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		update(input)
	end
end)

print("‚ö° Sprizan Admin Spammer UI Loaded!")
print("üü¢ Green = Enabled | üî¥ Red = Disabled")
print("üìä Loaded " .. #Players:GetPlayers() - 1 .. " players")